<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Edit Todo</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="../css/style.css" rel="stylesheet">
</head>
<body>

    <header class="app-header">
        <div class="header-content">
            <a href="index.html" class="logo"><i class="bi bi-journal-check"></i> My Todo</a>
            <nav class="menu">
                <a href="index.html">Home</a>
                <a href="write.html">Write</a>
            </nav>
        </div>
    </header>

    <main class="main-layout">
        <div class="card-box">
            <h2 style="text-align: center; margin-bottom: 30px; font-weight: 700;">할 일 수정</h2>
            
            <form action="../php/update.php" method="POST">
                <input type="hidden" id="Id" name="id">

                <div class="input-box">
                    <label class="label">내용</label>
                    <input type="text" id="DueText" name="task" class="input-text">
                </div>

                <div class="input-box">
                    <label class="label">마감일</label>
                    <input type="date" id="DueDate" name="dueDate" class="input-text">
                </div>

                <div style="margin-top: 30px;">
                    <button type="submit" class="btn-main full">수정 완료</button>
                    <a href="index.html" class="btn-sub">취소</a>
                </div>
            </form>
        </div>
    </main>

    <script>
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');
        // 수정할 데이터를 불러오기 위해 todo_single.php 호출
        if(id){
            fetch(`../php/todo_single.php?id=${id}`).then(res => res.json()).then(data => {
                document.getElementById('Id').value = data.id;
                document.getElementById('DueText').value = data.task;
                if(data.due_date) document.getElementById('DueDate').value = data.due_date.split('T')[0];
            });
        }
    </script>
</body>
</html>